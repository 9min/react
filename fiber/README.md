# Fiber

**React Fiber**는 React reconciler(조정자)의 재 구현입니다.  
재귀를 기반으로 하기 때문에 React v15 이전 버전에 소급적으로 적용된 조정 알고리즘을 재 작성했습니다.  

## reconciler를 왜 재 작성했는가?

아마도 주된 이유 중 하나는 우리가 브라우저에서 겪었던 역사적인 문제입니다.  

**메인 스레드는 UI 스레드와 동일합니다.**  

페이지 렌더링, 사용자 액션에 대한 응답, JS 계산, 네트워크 활동 관리 및 DOM 조작은 모두 브라우저 메인 스레드에서 처리합니다.  
이러한 것들 중 일부는 워커를 사용하여 다른 스레드에서 처리할 수 있지만 **DOM은 메인 스레드에서만 변경할 수 있습니다**.  

React에서 state가 변경되거나 props가 업데이트되면 `render()`함수는 React Elements의 새 트리를 만들고 다음 React가 조정 알고리즘을 실행하여 UI를 효율적으로 업데이트해서 새 트리와 일치시키는 방법을 찾습니다.  

`React Stack` reconciler는 항상 단일 패스에서 컴포넌트 트리를 동기화하여 처리합니다.  
이렇게 하면 재귀 프로세스가 완료될 때까지 메인 스레드가 다른 긴급한 작업을 해행하지 못합니다.  
사용자가 텍스트를 입력하는 동안 실시간으로 계속 계산이 실행된다면 앱이 응답하지 않아 프레임 속도가 고르지 않고 입력이 느려질 수 있습니다.  

새 `Fiber` reconciler의 주요 목표는 중단 가능한 작업을 여러 유형의 업데이트에 우선순위를 할당해서 메인 스레드가 diff 알고리즘을 일시 중지하고 다른 더 긴급한 작업을 수행할 수 있도록 하고 나중에 중단한 곳에서 다시 계속 진행할 수 있도록 중단 가능한 작업을 청크로 나누는 것입니다.  

`Fiber`는 다음과 같은 기능을 사용할 수 있습니다.  

- **아직 화면에 표시되지 않은 로직이 있으면 나중에 처리되도록 지연시킬 수 있습니다.**  
  => 데이터가 프레임 속도보다 빠르게 처리되면 통합 및 배치 업데이트를 수행하는 데 있어서 유리합니다. 
- **작업의 우선순위를 제어할 수 있습니다.**  
  => 프레임이 끊기지 않도록 덜 중요한 작업들(예: 네트워크에서 방금 로드한 새로운 콘텐츠를 렌더링)보다  
  사용자의 상호작용(예: 버튼 클릭으로 인한 애니메이션)에서 오는 작업의 우선순위를 더 높게 해서 먼저 처리하게 할 수 있습니다.  



[참고]  
- [What is React Fiber ?](https://giamir.com/what-is-react-fiber)
- [남다른 개선방법을 다시 보여준 페이스북의 React Fiber](https://medium.com/@codesquad_yoda/%EB%82%A8%EB%8B%A4%EB%A5%B8-%EA%B0%9C%EC%84%A0%EB%B0%A9%EB%B2%95%EC%9D%84-%EB%8B%A4%EC%8B%9C-%EB%B3%B4%EC%97%AC%EC%A4%80-%ED%8E%98%EC%9D%B4%EC%8A%A4%EB%B6%81%EC%9D%98-react-fiber-80b7ca5bd9bb)
- [React Fiber](https://tech.wanted.co.kr/frontend/2018/01/07/react-fiber.html)
- 